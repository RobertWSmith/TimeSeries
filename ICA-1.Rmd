% Robert Smith
% In-class Exercise: Fitting Dow Jones Data with ARIMA
% \today

```{r base_setup, include=FALSE}
knit_hooks$set(fig.keep='none')
library(TSA)
```

1. Read in dowj.txt file.  Plot the time series. Does the plot looks stationary? Plot ACF and PACF of the series. Test for the stationarity using Augmented Dickey-Fuller Unit-Root test.

```{r Q1}
D  <- read.csv("http://gozips.uakron.edu/~nmimoto/pages/datasets/dowj.csv")
D1 <- ts(D, start=c(1,1), freq=1)

plot(D1, type='o')
acf(D1)
pacf(D1)
adf.test(D1, alternative = "stationary")
```

The as-is data does not appear to be stationary because the mean does not appear to be stationary over time. When we apply the acf() function we can see significant autocorrelation over approximately 20 lags. When the pacf() function is applied it tails off after lag-zero, thus indicating a potential AR or ARMA model.

Based on the results of the Augmented Dickey-Fuller Unit-Root test for statinarity, p-value = 0.6552 and therefore we fail to reject $H_0$, and therefore cannot find that the time series has unit root and is stationary.

2. Take the difference of dowj data. Plot the time series. Does the plot looks stationary? Plot ACF and PACF of the series. What does ADF test say about stationarity?

```{r Q2}

D2 <- diff(D1)
plot(D2, type='o')
acf(D2)
pacf(D2)
adf.test(D2, alternative = "stationary")

```

The plot appears more stationary than the raw data, but when the ADF test is applied the p-value of 0.5617 shows that the we still reject $H_0$ and cannot say the time-series is stationary.

3. Take additional difference of dowj data. Plot the time series. Does the plot looks stationary? Plot ACF and PACF of the series. What does ADF test say about stationarity?

```{r Q3}
D3 <- diff(D2)
plot(D3, type='o')
acf(D3)
pacf(D3)
adf.test(D3, alternative = "stationary")
```

Based on the view of the data which has been further differenced the graph does not appear to be significantly different by eye, but when the ADF test was applied a p-value < 0.01 was found and therefore we fail to reject $H_0$ and find that it is possible that this time-series is stationary.

2b. Now based on what we saw in question 2, model the origianl dowj data with ARIMA(p, 1, q). Use auto.arima() in forecast package to choose p and q based on AICc. Diagnose the residual after the fit.  Is the model fitting well? If not, manually search for better value of p and q.  

```{r Q2B}
library(forecast)

auto.arima(D1, d=1, stepwise=FALSE, seasonal=FALSE, trace=TRUE)
ARIMA1 <- auto.arima(D1, d=1, stepwise=FALSE, seasonal=FALSE)
ARIMA2 <- auto.arima(D1, d=1, stepwise=TRUE, seasonal=FALSE)

summary(ARIMA1)
summary(ARIMA2)

```

Given the above code, I find that both ARIMA(1,1,1) & ARIMA(1,1,0) with drift are the two models with the lowest AIC each. While ARIMA(1,1,1)'s AIC is 0.001 less than the ARIMA(1,1,0) with drift's AIC when we look at the forecast of each model there are distinct differences.

2c. Using the model you came up in the previous question, give 5-day prediction of dowj value.  Plot the data(black) and predictioin(red) on the same plot. The range of x-axis must be suitablly chosen. 

```{r Q2C}



```

2d. In part (2-b), your ARIMA parameter estimation gave standard errors for estimation.  Can you trust that number?  Why?  How would you verify?

```{r Q2D}

```

3b. Now based on what we saw in question 3, model the origianl dowj data with ARIMA(p, 2, q).  
# Use auto.arima() in forecast package to choose p and q based on AICc. Diagnose the residual after the fit.  Is the model fitting well? If not, manually search for better value of p and q.

```{r Q3B}

```

3c. Using the model you came up in the previous question, give 5-day prediction of dowj value.  Plot the data(black) and predictioin(red) on the same plot. The range of x-axis must be suitablly chosen. 

```{r Q3C}

```

4. (optional) Can you come up with some other way of fitting the dowj model?  

```{r Q4}

```

5. Which model do you like better (2-b), (3-b) or 4? Why?

